---
- name: Install ufw
  ansible.builtin.apt:
    name: ufw
    state: latest

- name: Reset ufw
  community.general.ufw:
    state: reset

- name: Common setup ufw
  ansible.builtin.command: "ufw {{ item }}"
  loop:
    - default deny incoming
    - default allow outgoing
    - allow 22

- name: Enable ufw
  community.general.ufw:
    state: enabled
